<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>PSYC 575 Multilevel Modeling (2021 Fall): R Codes (Week 2)</title>




  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="PSYC 575 Multilevel Modeling (2021 Fall): R Codes (Week 2)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="PSYC 575 Multilevel Modeling (2021 Fall)"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="PSYC 575 Multilevel Modeling (2021 Fall): R Codes (Week 2)"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","output","params"]}},"value":[{"type":"character","attributes":{},"value":["R Codes (Week 2)"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc"]}},"value":[{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["rmd_file"]}},"value":[{"type":"character","attributes":{},"value":["week2-review-multiple-regression"]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-103807117-1"></script>
  <script type="text/javascript" cookie-consent="tracking">
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-103807117-1');
  </script>
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"R Codes (Week 2)","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">PSYC 575 Multilevel Modeling (2021 Fall)</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="syllabus.html">Syllabus</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Lectures
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="week1.html">Week 1</a>
<a href="week2.html">Week 2</a>
<a href="week3.html">Week 3</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R Codes
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="rcode1.html">Week 1 R Code</a>
<a href="rcode2.html">Week 2 R Code</a>
<a href="rcode3.html">Week 3 R Code</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>R Codes (Week 2)</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#simulation">Simulation</a></li>
<li><a href="#load-packages-and-import-data">Load Packages and Import Data</a>
<ul>
<li><a href="#import-data">Import Data</a></li>
</ul></li>
<li><a href="#quick-scatterplot-matrix">Quick Scatterplot Matrix</a></li>
<li><a href="#linear-regression-of-salary-on-pub">1. Linear Regression of <code>salary</code> on <code>pub</code></a>
<ul>
<li><a href="#visualize-the-data">Visualize the data</a></li>
<li><a href="#linear-regression">Linear regression</a></li>
<li><a href="#visualize-fitted-regression-line">Visualize fitted regression line:</a></li>
<li><a href="#confidence-intervals">Confidence intervals</a></li>
<li><a href="#interpretations">Interpretations</a></li>
<li><a href="#simulations">Simulations</a></li>
<li><a href="#p-values"><span class="math inline">\(p\)</span> values</a></li>
<li><a href="#centering">Centering</a></li>
</ul></li>
<li><a href="#categorical-predictor">2. Categorical Predictor</a>
<ul>
<li><a href="#equivalence-to-the-t-test">Equivalence to the <span class="math inline">\(t\)</span>-test</a></li>
</ul></li>
<li><a href="#multiple-predictors-multiple-regression">3. Multiple Predictors (Multiple Regression)</a>
<ul>
<li><a href="#plotting">Plotting</a></li>
<li><a href="#interpretations-1">Interpretations</a></li>
<li><a href="#diagnostics">Diagnostics</a></li>
<li><a href="#effect-size">Effect size</a></li>
</ul></li>
<li><a href="#interaction">4. Interaction</a>
<ul>
<li><a href="#interaction-plots">Interaction Plots</a></li>
</ul></li>
<li><a href="#tabulate-the-regression-results">5. Tabulate the Regression Results</a></li>
<li><a href="#bonus-matrix-form-of-regression">Bonus: Matrix Form of Regression</a></li>
<li><a href="#bonus-more-options-in-formatting-tables">Bonus: More Options in Formatting Tables</a></li>
</ul>
</nav>
</div>
<div class="hidden">
<p><span class="math display">\[
\newcommand{\bv}[1]{\boldsymbol{\mathbf{#1}}}
\]</span></p>
</div>
<p>Click here to download the Rmd file: <a href="rcodes/week2-review-multiple-regression.Rmd">week2-review-multiple-regression.Rmd</a></p>
<h2 id="simulation">Simulation</h2>
<div class="layout-chunk" data-layout="l-body">
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
<iframe src="https://www.youtube.com/embed/ka4Y5jYL3wM" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube Video" allowfullscreen=""></iframe>
</div>
</div>
<p>Practice yourself: From the simulation code provided, try to increase the sample size from 62 to something larger, like 200. How does this affect the uncertainty in the sample slopes?</p>
<hr />
<h2 id="load-packages-and-import-data">Load Packages and Import Data</h2>
<p>You can use add the <code>message=FALSE</code> option to suppress the package loading messages</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># To install a package, run the following ONCE (and only once on your computer)</span>
<span class='co'># install.packages("psych")  </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://personality-project.org/r/psych/'>psych</a></span><span class='op'>)</span>  <span class='co'># for scatterplot matrix</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span>  <span class='co'># makes reading data more consistent</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>  <span class='co'># for data manipulation and plotting</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://r-forge.r-project.org/projects/car/'>car</a></span><span class='op'>)</span>  <span class='co'># some useful functions for regression</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://vincentarelbundock.github.io/modelsummary/'>modelsummary</a></span><span class='op'>)</span>  <span class='co'># for making tables</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span>  <span class='co'># for plotting slopes</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://interactions.jacob-long.com'>interactions</a></span><span class='op'>)</span>  <span class='co'># for plotting interactions</span>
<span class='fu'>theme_set</span><span class='op'>(</span><span class='fu'>theme_bw</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># Theme; just my personal preference</span>
</code></pre>
</div>
</div>
<h3 id="import-data">Import Data</h3>
<p>First, download the data file <code>salary.txt</code> from <a href="https://raw.githubusercontent.com/marklhc/marklai-pages/master/data_files/salary.txt" class="uri">https://raw.githubusercontent.com/marklhc/marklai-pages/master/data_files/salary.txt</a>, and import the data. A robust way to do so is to download the data to a folder called <code>data_files</code> under the project directory, and then use the <code>here</code> package. This avoids a lot of data import issues that I’ve seen.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># The `here()` function forces the use of the project directory</span>
<span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data_files"</span>, <span class='st'>"salary.txt"</span><span class='op'>)</span>
<span class='co'># Read in the data</span>
<span class='va'>salary_dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data_files"</span>, <span class='st'>"salary.txt"</span><span class='op'>)</span>, header <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Alternatively, from the menu, click <code>File</code> → <code>Import Dataset</code> → <code>From Text (base)...</code>, and select the file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Show the data</span>
<span class='va'>salary_dat</span>
</code></pre>
</div>
<pre><code>&gt;#    id time pub sex citation salary
&gt;# 1   1    3  18   1       50  51876
&gt;# 2   2    6   3   1       26  54511
&gt;# 3   3    3   2   1       50  53425
&gt;# 4   4    8  17   0       34  61863
&gt;# 5   5    9  11   1       41  52926
&gt;# 6   6    6   6   0       37  47034
&gt;# 7   7   16  38   0       48  66432
&gt;# 8   8   10  48   0       56  61100
&gt;# 9   9    2   9   0       19  41934
&gt;# 10 10    5  22   0       29  47454
&gt;# 11 11    5  30   1       28  49832
&gt;# 12 12    6  21   0       31  47047
&gt;# 13 13    7  10   1       25  39115
&gt;# 14 14   11  27   0       40  59677
&gt;# 15 15   18  37   0       61  61458
&gt;# 16 16    6   8   0       32  54528
&gt;# 17 17    9  13   1       36  60327
&gt;# 18 18    7   6   0       69  56600
&gt;# 19 19    7  12   1       47  52542
&gt;# 20 20    3  29   1       29  50455
&gt;# 21 21    7  29   1       35  51647
&gt;# 22 22    5   7   0       35  62895
&gt;# 23 23    7   6   0       18  53740
&gt;# 24 24   13  69   0       90  75822
&gt;# 25 25    5  11   0       60  56596
&gt;# 26 26    8   9   1       30  55682
&gt;# 27 27    8  20   1       27  62091
&gt;# 28 28    7  41   1       35  42162
&gt;# 29 29    2   3   1       14  52646
&gt;# 30 30   13  27   0       56  74199
&gt;# 31 31    5  14   0       50  50729
&gt;# 32 32    3  23   0       25  70011
&gt;# 33 33    1   1   0       35  37939
&gt;# 34 34    3   7   0        1  39652
&gt;# 35 35    9  19   0       69  68987
&gt;# 36 36    3  11   0       69  55579
&gt;# 37 37    9  31   0       27  54671
&gt;# 38 38    3   9   0       50  57704
&gt;# 39 39    4  12   1       32  44045
&gt;# 40 40   10  32   0       33  51122
&gt;# 41 41    1  26   0       45  47082
&gt;# 42 42   11  12   0       54  60009
&gt;# 43 43    5   9   0       47  58632
&gt;# 44 44    1   6   0       29  38340
&gt;# 45 45   21  39   0       69  71219
&gt;# 46 46    7  16   1       47  53712
&gt;# 47 47    5  12   1       43  54782
&gt;# 48 48   16  50   0       55  83503
&gt;# 49 49    5  18   0       33  47212
&gt;# 50 50    4  16   1       28  52840
&gt;# 51 51    5   5   0       42  53650
&gt;# 52 52   11  20   0       24  50931
&gt;# 53 53   16  50   1       31  66784
&gt;# 54 54    3   6   1       27  49751
&gt;# 55 55    4  19   1       83  74343
&gt;# 56 56    4  11   1       49  57710
&gt;# 57 57    5  13   0       14  52676
&gt;# 58 58    6   3   1       36  41195
&gt;# 59 59    4   8   1       34  45662
&gt;# 60 60    8  11   1       70  47606
&gt;# 61 61    3  25   1       27  44301
&gt;# 62 62    4   4   1       28  58582</code></pre>
</div>
<p>You can see the description of the variables here: <a href="https://rdrr.io/cran/MBESS/man/prof.salary.html" class="uri">https://rdrr.io/cran/MBESS/man/prof.salary.html</a></p>
<h2 id="quick-scatterplot-matrix">Quick Scatterplot Matrix</h2>
<p>Import to screen your data before any statistical modeling</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/pkg/psych/man/pairs.panels.html'>pairs.panels</a></span><span class='op'>(</span><span class='va'>salary_dat</span><span class='op'>[</span> , <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>,  <span class='co'># not plotting the first column</span>
             ellipses <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/pairs-salary_dat-1.png" width="624" /></p>
</div>
<h2 id="linear-regression-of-salary-on-pub">1. Linear Regression of <code>salary</code> on <code>pub</code></h2>
<h3 id="visualize-the-data">Visualize the data</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Visualize the data ("gg" stands for grammar of graphics)</span>
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>salary_dat</span>,  <span class='co'># specify data</span>
             <span class='co'># aesthetics: mapping variable to axes)</span>
             <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>salary</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>  
             <span class='co'># geom: geometric objects, such as points, lines, shapes, etc</span>
             <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span>
<span class='co'># Add a smoother geom to visualize mean salary as a function of pub</span>
<span class='va'>p1</span> <span class='op'>+</span> <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/p1-smooth-1.png" width="624" /></p>
</div>
<p>A little bit of non-linearity on the plot. Now fit the regression model</p>
<h3 id="linear-regression">Linear regression</h3>
<p>You can type equations (with LaTeX; see a <a href="https://www.latex-tutorial.com/tutorials/amsmath/">quick reference</a>).</p>
<p>P.S. Use <code>\text{}</code> to specify variable names</p>
<p>P.S. Pay attention to the subscripts</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}_i + e_i\]</span></p>
<ul>
<li>Outcome: <code>salary</code></li>
<li>Predictor: <code>pub</code></li>
<li><span class="math inline">\(\beta_0\)</span>: regression intercept</li>
<li><span class="math inline">\(\beta_1\)</span>: regression slope</li>
<li><span class="math inline">\(e\)</span>: error</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># left hand side of ~ is outcome; right hand side contains predictors</span>
<span class='co'># salary ~ (beta_0) * 1 + (beta_1) * pub</span>
<span class='co'># remove beta_0 and beta_1 to get the formula</span>
<span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='fl'>1</span> <span class='op'>+</span> <span class='va'>pub</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>
<span class='co'># In R, the output is not printed out if it is saved to an object (e.g., m1).</span>
<span class='co'># Summary:</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ 1 + pub, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#      Min       1Q   Median       3Q      Max 
&gt;# -20660.0  -7397.5    333.7   5313.9  19238.7 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 48439.09    1765.42  27.438  &lt; 2e-16 ***
&gt;# pub           350.80      77.17   4.546 2.71e-05 ***
&gt;# ---
&gt;# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt;# 
&gt;# Residual standard error: 8440 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.2562, Adjusted R-squared:  0.2438 
&gt;# F-statistic: 20.67 on 1 and 60 DF,  p-value: 2.706e-05</code></pre>
</div>
<h3 id="visualize-fitted-regression-line">Visualize fitted regression line:</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>+</span>
  <span class='co'># Non-parametric fit</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># Linear regression line (in red)</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/p1-fitted-1.png" width="624" /></p>
</div>
<h3 id="confidence-intervals">Confidence intervals</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Confidence intervals</span>
<span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;#                 2.5 %     97.5 %
&gt;# (Intercept) 44907.729 51970.4450
&gt;# pub           196.441   505.1625</code></pre>
</div>
<h3 id="interpretations">Interpretations</h3>
<blockquote>
<p>Based on our model, faculty with one more publication have predicted salary of $350.8, 95% CI [$196.4, $505.2], higher than those with one less publication.</p>
</blockquote>
<p>But what do the confidence intervals and the standard errors mean? To understanding what exactly a regression model is, let’s run some simulations.</p>
<hr />
<h3 id="simulations">Simulations</h3>
<p>Before you go on, take a look on a <a href="https://www.youtube.com/watch?v=pGvJl8vvlXY">brief introductory video</a> by Clark Caylord on Youtube on simulating data based on a simple linear regression model.</p>
<p>To my delight, I also found out a gentle introduction of simulation method by one of our clinical science students at USC (Thanks Kayla!). You can access it through the USC library <a href="https://libproxy1.usc.edu/login?url=http://sk.sagepub.com.libproxy2.usc.edu/reference/sage-encyclopedia-of-educational-research-measurement-evaluation/i13837.xml">here</a> (Sign-on required). Here’s the citation:</p>
<p>Tureson, K. &amp; Odland, A. (2018). Monte Carlo simulation studies. In B. Frey (Ed.),The SAGE Encyclopedia of Educational Research, Measurement, and Evaluation. Thousand Oaks, CA: SAGE Publications.</p>
<p>Based on the analyses, the sample regression line is <span class="math display">\[\widehat{\text{salary}} = 48439.09 + 350.80 \text{pub}.\]</span> The numbers are only sample estimates as there are sampling errors. However, if we assume that this line truly describe the relation between <code>salary</code> and <code>pub</code>, then we can simulate some fake data, which represents what we could have obtained in a different sample.</p>
<p>Going back to the equation <span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}_i + e_i,\]</span> the only thing that changes across different samples, based on the statistical model, is <span class="math inline">\(e_i\)</span>. Conceptually, you can think of the error term <span class="math inline">\(e_i\)</span> as <strong>the deviation of person <span class="math inline">\(i\)</span>’s salary from the mean salary of everyone in the population who has the same number of publications as person <span class="math inline">\(i\)</span>.</strong> Here we assume that <span class="math inline">\(e_i\)</span> is normally distributed, written as <span class="math inline">\(e_i \sim N(0, \sigma)\)</span>, where <span class="math inline">\(\sigma\)</span> describes the conditional standard deviation (i.e., the standard deviation across individuals who have the same number of publications). From the regression results, <span class="math inline">\(\sigma\)</span> is estimated as the <code>Residual standard error</code> = 8,440.</p>
<p>Based on these model assumptions, we can imagine a large population, say with 10,000 people</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Simulating a large population. The code in this chunk </span>
<span class='co'># is not essential for conceptual understanding</span>
<span class='va'>Npop</span> <span class='op'>&lt;-</span> <span class='fl'>10000</span>
<span class='va'>beta0</span> <span class='op'>&lt;-</span> <span class='fl'>48439.09</span>
<span class='va'>beta1</span> <span class='op'>&lt;-</span> <span class='fl'>350.80</span>
<span class='va'>sigma</span> <span class='op'>&lt;-</span> <span class='fl'>8440</span>
<span class='co'># Simulate population data</span>
<span class='va'>simulated_population</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>
  <span class='co'># Simulate population pub</span>
  pub <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/eval.html'>local</a></span><span class='op'>(</span><span class='op'>{</span>
    <span class='va'>dens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>salary_dat</span><span class='op'>$</span><span class='va'>pub</span>, <span class='va'>salary_dat</span><span class='op'>$</span><span class='va'>pub</span><span class='op'>)</span>,
      bw <span class='op'>=</span> <span class='st'>"SJ"</span>,
      n <span class='op'>=</span> <span class='fl'>1024</span>
    <span class='op'>)</span>
    <span class='va'>dens_x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>dens</span><span class='op'>$</span><span class='va'>x</span><span class='op'>[</span><span class='va'>dens</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>
    <span class='va'>dens_y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='va'>dens</span><span class='op'>$</span><span class='va'>y</span><span class='op'>[</span><span class='va'>dens</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/stats/approxfun.html'>approx</a></span><span class='op'>(</span>
        <span class='fu'><a href='https://rdrr.io/r/base/cumsum.html'>cumsum</a></span><span class='op'>(</span><span class='va'>dens_y</span><span class='op'>)</span> <span class='op'>/</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>dens_y</span><span class='op'>)</span>,
        <span class='va'>dens_x</span>,
        <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='va'>Npop</span><span class='op'>)</span>
      <span class='op'>)</span><span class='op'>$</span><span class='va'>y</span>
    <span class='op'>)</span>
  <span class='op'>}</span><span class='op'>)</span>,
  <span class='co'># Simulate error</span>
  e <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>Npop</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='va'>sigma</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='co'># Compute salary variable</span>
<span class='va'>simulated_population</span><span class='op'>$</span><span class='va'>salary</span> <span class='op'>&lt;-</span>
  <span class='va'>beta0</span> <span class='op'>+</span> <span class='va'>beta1</span> <span class='op'>*</span> <span class='va'>simulated_population</span><span class='op'>$</span><span class='va'>pub</span> <span class='op'>+</span> <span class='va'>simulated_population</span><span class='op'>$</span><span class='va'>e</span>
<span class='co'># Plot</span>
<span class='va'>p_pop</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>
  data <span class='op'>=</span> <span class='va'>simulated_population</span>,
  <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>salary</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='co'># Add population regression line in blue</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>se <span class='op'>=</span> <span class='cn'>FALSE</span>, method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span>
<span class='va'>p_pop</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/fake-pop-1.png" width="624" /></p>
</div>
<p>Now, we can simulate some fake (but plausible) samples. An important thing to remember is we want to <strong>simulate data that have the same size as the original sample</strong>, because we’re comparing to other plausible samples with equal size. In R there is a handy <code>simulate()</code> function to do that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simulated_salary</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
<span class='co'># Add simulated salary to the original data</span>
<span class='co'># Note: the simulated variable is called `sim_1`</span>
<span class='va'>sim_data1</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>salary_dat</span>, <span class='va'>simulated_salary</span><span class='op'>)</span>
<span class='co'># Show the first six rows</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>sim_data1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;#   id time pub sex citation salary    sim_1
&gt;# 1  1    3  18   1       50  51876 51047.35
&gt;# 2  2    6   3   1       26  54511 47074.54
&gt;# 3  3    3   2   1       50  53425 49010.13
&gt;# 4  4    8  17   0       34  61863 64235.96
&gt;# 5  5    9  11   1       41  52926 49844.51
&gt;# 6  6    6   6   0       37  47034 51161.96</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Plot the data (add on to the population)</span>
<span class='va'>p_pop</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>sim_data1</span>, 
             <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>sim_1</span><span class='op'>)</span>,
             col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='co'># Add sample regression line</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>sim_data1</span>, 
              <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>sim_1</span><span class='op'>)</span>,
              method <span class='op'>=</span> <span class='st'>"lm"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/sim-data1-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># To be more transparent, here's what the simulate() function essentially is</span>
<span class='co'># doing</span>
<span class='va'>sample_size</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>salary_dat</span><span class='op'>)</span>
<span class='va'>sim_data1</span> <span class='op'>&lt;-</span> <span class='fu'>tibble</span><span class='op'>(</span>
  pub <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>$</span><span class='va'>pub</span>,
  <span class='co'># simulate error</span>
  e <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>sample_size</span>, mean <span class='op'>=</span> <span class='fl'>0</span>, sd <span class='op'>=</span> <span class='va'>sigma</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='co'># Compute new salary data</span>
<span class='va'>sim_data1</span><span class='op'>$</span><span class='va'>sim_1</span> <span class='op'>&lt;-</span> <span class='va'>beta0</span> <span class='op'>+</span> <span class='va'>beta1</span> <span class='op'>*</span> <span class='va'>sim_data1</span><span class='op'>$</span><span class='va'>pub</span> <span class='op'>+</span> <span class='va'>sim_data1</span><span class='op'>$</span><span class='va'>e</span>
</code></pre>
</div>
</div>
<p>As you can see, the sample regression line in red is different from the blue line.</p>
<h4 id="drawing-100-samples">Drawing 100 samples</h4>
<p>Let’s draw more samples</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>num_samples</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>simulated_salary100</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>m1</span>, nsim <span class='op'>=</span> <span class='va'>num_samples</span><span class='op'>)</span>
<span class='co'># Form a giant data set with 100 samples</span>
<span class='va'>sim_data100</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>salary_dat</span>, <span class='va'>simulated_salary100</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='va'>sim_1</span><span class='op'>:</span><span class='va'>sim_100</span>,
    names_prefix <span class='op'>=</span> <span class='st'>"sim_"</span>,
    names_to <span class='op'>=</span> <span class='st'>"sim"</span>,
    values_to <span class='op'>=</span> <span class='st'>"simulated_salary"</span>
  <span class='op'>)</span>
<span class='co'># Plot by samples</span>
<span class='va'>p_sim100</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span>
  <span class='va'>sim_data100</span>,
  <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>simulated_salary</span>, group <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span>
<span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, alpha <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"red"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span>, method <span class='op'>=</span> <span class='st'>"lm"</span><span class='op'>)</span>
<span class='co'># Use gganimate (this takes some time to render)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://gganimate.com'>gganimate</a></span><span class='op'>)</span>
<span class='va'>p_sim100</span> <span class='op'>+</span> <span class='fu'><a href='https://gganimate.com/reference/transition_states.html'>transition_states</a></span><span class='op'>(</span><span class='va'>sim</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Simulation {frame} of {nframes}"</span><span class='op'>)</span>
<span class='fu'><a href='https://gganimate.com/reference/anim_save.html'>anim_save</a></span><span class='op'>(</span><span class='fu'>here</span><span class='fu'>::</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"sim-100-samples.gif"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><img src="sim-100-samples.gif" /></p>
<p>We can show the regression lines for all 100 samples</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>sim_data100</span>,
       <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>simulated_salary</span>, group <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>stat_smooth</span><span class='op'>(</span>
    geom <span class='op'>=</span> <span class='st'>"line"</span>,
    col <span class='op'>=</span> <span class='st'>"red"</span>,
    se <span class='op'>=</span> <span class='cn'>FALSE</span>,
    method <span class='op'>=</span> <span class='st'>"lm"</span>,
    alpha <span class='op'>=</span> <span class='fl'>0.4</span>
  <span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/plot-sim_data100-1.png" width="624" /></p>
</div>
<p>The confidence intervals of the intercept and the slope how much uncertainty there is.</p>
<h3 id="p-values"><span class="math inline">\(p\)</span> values</h3>
<p>Now, we can also understand the <span class="math inline">\(p\)</span> value for the regression slope of <code>pub</code> is. Remember that the <span class="math inline">\(p\)</span> value is the probability that, if the regression slope of <code>pub</code> is zero (i.e., no association), how likely/unlikely would we get the sample slope (i.e., 350.80) in our data. So now we’ll repeat the simulation, but without <code>pub</code> as a predictor (i.e., assuming <span class="math inline">\(\beta_1 = 0\)</span>).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>num_samples</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>m0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='fl'>1</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>  <span class='co'># null model</span>
<span class='va'>simulated_salary100_null</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/simulate.html'>simulate</a></span><span class='op'>(</span><span class='va'>m0</span>, nsim <span class='op'>=</span> <span class='va'>num_samples</span><span class='op'>)</span>
<span class='co'># Form a giant data set with 100 samples</span>
<span class='va'>sim_null100</span> <span class='op'>&lt;-</span> <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>salary_dat</span>, <span class='va'>simulated_salary100_null</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>pivot_longer</span><span class='op'>(</span><span class='va'>sim_1</span><span class='op'>:</span><span class='va'>sim_100</span>, 
               names_prefix <span class='op'>=</span> <span class='st'>"sim_"</span>, 
               names_to <span class='op'>=</span> <span class='st'>"sim"</span>, 
               values_to <span class='op'>=</span> <span class='st'>"simulated_salary"</span><span class='op'>)</span>
<span class='co'># Show the null slopes</span>
<span class='fu'>ggplot</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>salary_dat</span>,
       <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>salary</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>stat_smooth</span><span class='op'>(</span>
    data <span class='op'>=</span> <span class='va'>sim_null100</span>,
    <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>pub</span>, y <span class='op'>=</span> <span class='va'>simulated_salary</span>, group <span class='op'>=</span> <span class='va'>sim</span><span class='op'>)</span>,
    geom <span class='op'>=</span> <span class='st'>"line"</span>,
    col <span class='op'>=</span> <span class='st'>"darkgrey"</span>,
    se <span class='op'>=</span> <span class='cn'>FALSE</span>,
    method <span class='op'>=</span> <span class='st'>"lm"</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, se <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/sim-null-1.png" width="624" /></p>
</div>
<p>So you can see the sample slope is larger than what you would expect to see if the true slope is zero. So the <span class="math inline">\(p\)</span> value is very small, and the result is statistically significant (at, say, .05 level).</p>
<hr />
<h3 id="centering">Centering</h3>
<p>So that the intercept refers to a more meaningful value. It’s a major issue in multilevel modeling.</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + e_i\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Using pipe operator</span>
<span class='va'>salary_dat</span> <span class='op'>&lt;-</span> <span class='va'>salary_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>pub_c <span class='op'>=</span> <span class='va'>pub</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>pub</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Equivalent to:</span>
<span class='co'># salary_dat &lt;- mutate(salary_dat, </span>
<span class='co'>#                      pub_c = pub - mean(pub))</span>
<span class='va'>m1c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='va'>pub_c</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1c</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#      Min       1Q   Median       3Q      Max 
&gt;# -20660.0  -7397.5    333.7   5313.9  19238.7 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 54815.76    1071.93  51.137  &lt; 2e-16 ***
&gt;# pub_c         350.80      77.17   4.546 2.71e-05 ***
&gt;# ---
&gt;# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt;# 
&gt;# Residual standard error: 8440 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.2562, Adjusted R-squared:  0.2438 
&gt;# F-statistic: 20.67 on 1 and 60 DF,  p-value: 2.706e-05</code></pre>
</div>
<p>The only change is the intercept coefficient</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p1</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='co'># Intercept without centering</span>
  <span class='fu'>geom_vline</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"Not centered"</span>, xintercept <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='co'># Intercept with centering</span>
  <span class='fu'>geom_vline</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"Centered"</span>, xintercept <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>salary_dat</span><span class='op'>$</span><span class='va'>pub</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/p1-center-1.png" width="624" /></p>
</div>
<h2 id="categorical-predictor">2. Categorical Predictor</h2>
<p>Recode <code>sex</code> as <code>factor</code> variable in R (which allows R to automatically do dummy coding). This should be done in general for categorical predictors.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>salary_dat</span> <span class='op'>&lt;-</span> <span class='va'>salary_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>sex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1</span><span class='op'>)</span>, 
                      labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"male"</span>, <span class='st'>"female"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{sex}_i + e_i\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='op'>(</span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>salary_dat</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>sex</span>, y <span class='op'>=</span> <span class='va'>salary</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_boxplot</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
    <span class='fu'>geom_jitter</span><span class='op'>(</span>height <span class='op'>=</span> <span class='fl'>0</span>, width <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># move the points to left/right a bit</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/p2-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='va'>sex</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ sex, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -18576  -5736    -19   4853  26988 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept)    56515       1620  34.875   &lt;2e-16 ***
&gt;# sexfemale      -3902       2456  -1.589    0.117    
&gt;# ---
&gt;# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt;# 
&gt;# Residual standard error: 9587 on 60 degrees of freedom
&gt;# Multiple R-squared:  0.04039,    Adjusted R-squared:  0.02439 
&gt;# F-statistic: 2.525 on 1 and 60 DF,  p-value: 0.1173</code></pre>
</div>
<p>The <code>(Intercept)</code> coefficient is for the ‘0’ category, i.e., predicted salary for males; the <code>female</code> coefficient is the difference between males and females.</p>
<p>Predicted female salary = 56515 + (-3902) = 52613.</p>
<h3 id="equivalence-to-the-t-test">Equivalence to the <span class="math inline">\(t\)</span>-test</h3>
<p>When assuming homogeneity of variance</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/t.test.html'>t.test</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='va'>sex</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span>, var.equal <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;#  Two Sample t-test
&gt;# 
&gt;# data:  salary by sex
&gt;# t = 1.5891, df = 60, p-value = 0.1173
&gt;# alternative hypothesis: true difference in means between group male and group female is not equal to 0
&gt;# 95 percent confidence interval:
&gt;#  -1009.853  8814.041
&gt;# sample estimates:
&gt;#   mean in group male mean in group female 
&gt;#             56515.06             52612.96</code></pre>
</div>
<h2 id="multiple-predictors-multiple-regression">3. Multiple Predictors (Multiple Regression)</h2>
<p>Now add one more predictor, <code>time</code> <span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + \beta_2 \text{time}_i + e_i\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>salary_dat</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>time</span>, y <span class='op'>=</span> <span class='va'>salary</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_smooth</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/p3-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='va'>pub_c</span> <span class='op'>+</span> <span class='va'>time</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span>  <span class='co'># summary</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c + time, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -15919  -5537   -985   4861  22476 
&gt;# 
&gt;# Coefficients:
&gt;#             Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept) 47373.38    2281.78  20.762  &lt; 2e-16 ***
&gt;# pub_c         133.00      92.73   1.434 0.156797    
&gt;# time         1096.03     303.58   3.610 0.000632 ***
&gt;# ---
&gt;# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt;# 
&gt;# Residual standard error: 7703 on 59 degrees of freedom
&gt;# Multiple R-squared:  0.3908, Adjusted R-squared:  0.3701 
&gt;# F-statistic: 18.92 on 2 and 59 DF,  p-value: 4.476e-07</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span>  <span class='co'># confidence interval</span>
</code></pre>
</div>
<pre><code>&gt;#                   2.5 %     97.5 %
&gt;# (Intercept) 42807.55413 51939.2044
&gt;# pub_c         -52.56216   318.5589
&gt;# time          488.56251  1703.4921</code></pre>
</div>
<p>The regression coefficients are the <em>partial</em> effects.</p>
<p><img src="https://github.com/marklhc/marklai-pages/raw/master/static/img/regression_venn.png" /></p>
<h3 id="plotting">Plotting</h3>
<p>The <code>sjPlot::plot_model()</code> function is handy</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>sjPlot</span><span class='fu'>::</span><span class='fu'><a href='https://strengejacke.github.io/sjPlot/reference/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>m3</span>, type <span class='op'>=</span> <span class='st'>"pred"</span>, show.data <span class='op'>=</span> <span class='cn'>TRUE</span>,
                   title <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>  <span class='co'># remove title</span>
</code></pre>
</div>
<pre><code>&gt;# $pub_c</code></pre>
<p><img src="rcode2_files/figure-html5/plot-m3-1.png" width="624" /></p>
<pre><code>&gt;# 
&gt;# $time</code></pre>
<p><img src="rcode2_files/figure-html5/plot-m3-2.png" width="624" /></p>
</div>
<h3 id="interpretations-1">Interpretations</h3>
<blockquote>
<p>Faculty who have worked <em>longer</em> tended to have <em>more</em> publications <strong>For faculty who graduate around the same time</strong>, a difference of 1 publication is associated with an estimated difference in salary of $133.0, 95% CI [$-52.6, $318.6], which was not significant.</p>
</blockquote>
<h3 id="diagnostics">Diagnostics</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>car</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/car/man/marginalModelPlot.html'>mmps</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span>  <span class='co'># marginal model plots for linearity assumptions</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/m3-diagnostics-1.png" width="624" /></p>
</div>
<p>The red line is the implied association based on the model, whereas the blue line is a non-parametric smoother not based on the model. If the two lines show big discrepancies (especially if in the middle), it may suggest the linearity assumptions in the model does not hold.</p>
<h3 id="effect-size">Effect size</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Extract the R^2 number (it's sometimes tricky to </span>
<span class='co'># figure out whether R stores the numbers you need)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>r.squared</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 0.3907761</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Adjusted R^2</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span><span class='op'>$</span><span class='va'>adj.r.squared</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 0.3701244</code></pre>
</div>
<p>Proportion of predicted variance: <span class="math inline">\(R^2\)</span> = 39%, adj. <span class="math inline">\(R^2\)</span> = 37%.</p>
<h2 id="interaction">4. Interaction</h2>
<p>For interpretation purposes, it’s recommended to center the predictors (at least the continuous ones)</p>
<p><span class="math display">\[\text{salary}_i = \beta_0 + \beta_1 \text{pub}^c_i + \beta_2 \text{time}^c_i + \beta_3 (\text{pub}^c_i)(\text{time}^c_i) + e_i\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>salary_dat</span> <span class='op'>&lt;-</span> <span class='va'>salary_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>time_c <span class='op'>=</span> <span class='va'>time</span> <span class='op'>-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Fit the model with interactions:</span>
<span class='va'>m4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>salary</span> <span class='op'>~</span> <span class='va'>pub_c</span> <span class='op'>*</span> <span class='va'>time_c</span>, data <span class='op'>=</span> <span class='va'>salary_dat</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m4</span><span class='op'>)</span>  <span class='co'># summary</span>
</code></pre>
</div>
<pre><code>&gt;# 
&gt;# Call:
&gt;# lm(formula = salary ~ pub_c * time_c, data = salary_dat)
&gt;# 
&gt;# Residuals:
&gt;#    Min     1Q Median     3Q    Max 
&gt;# -14740  -5305   -373   4385  22744 
&gt;# 
&gt;# Coefficients:
&gt;#              Estimate Std. Error t value Pr(&gt;|t|)    
&gt;# (Intercept)  54238.08    1183.01  45.847  &lt; 2e-16 ***
&gt;# pub_c          104.72      98.41   1.064  0.29169    
&gt;# time_c         964.17     339.68   2.838  0.00624 ** 
&gt;# pub_c:time_c    15.07      17.27   0.872  0.38664    
&gt;# ---
&gt;# Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
&gt;# 
&gt;# Residual standard error: 7719 on 58 degrees of freedom
&gt;# Multiple R-squared:  0.3987, Adjusted R-squared:  0.3676 
&gt;# F-statistic: 12.82 on 3 and 58 DF,  p-value: 1.565e-06</code></pre>
</div>
<h3 id="interaction-plots">Interaction Plots</h3>
<p>Interpreting interaction effects is hard. Therefore,</p>
<blockquote>
<p>Always plot the interaction to understand the dynamics</p>
</blockquote>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>interactions</span><span class='fu'>::</span><span class='fu'><a href='https://interactions.jacob-long.com/reference/interact_plot.html'>interact_plot</a></span><span class='op'>(</span><span class='va'>m4</span>,
  pred <span class='op'>=</span> <span class='st'>"pub_c"</span>,
  modx <span class='op'>=</span> <span class='st'>"time_c"</span>,
  <span class='co'># Insert specific values to plot the slopes.</span>
  <span class='co'># Pay attention that `time_c` has been centered</span>
  modx.values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>7</span>, <span class='fl'>15</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>6.79</span>,
  modx.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>7</span>, <span class='fl'>15</span><span class='op'>)</span>,
  plot.points <span class='op'>=</span> <span class='cn'>TRUE</span>,
  x.label <span class='op'>=</span> <span class='st'>"Number of publications (mean-centered)"</span>,
  y.label <span class='op'>=</span> <span class='st'>"Salary"</span>,
  legend.main <span class='op'>=</span> <span class='st'>"Time since Ph.D."</span>
<span class='op'>)</span>
</code></pre>
</div>
<p><img src="rcode2_files/figure-html5/interaction-plot-1.png" width="624" /></p>
</div>
<p>Another approach is to plug in numbers to the equation: <span class="math display">\[\widehat{\text{salary}} = \hat \beta_0 + \hat \beta_1 \text{pub}^c + \hat \beta_2 \text{time}^c + \hat \beta_3 (\text{pub}^c)(\text{time}^c)\]</span> For example, consider people who’ve graduated for seven years, i.e., <code>time</code> = 7. First, be careful that in the model we have <code>time_c</code>, and <code>time</code> = 7 corresponds to <code>time_c</code> = 0.2096774 years. So if we plug that into the equation, <span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = \hat \beta_0 + \hat \beta_1 \text{pub}^c + \hat \beta_2 (0.21) + \hat \beta_3 (\text{pub}^c)(0.21)\]</span> Combining terms with pub<sup>c</sup>, <span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = [\hat \beta_0 + \hat \beta_2 (0.21)] + [\hat \beta_1 + \hat \beta_3 (0.21)] (\text{pub}^c)\]</span> Now plug in the numbers for <span class="math inline">\(\hat \beta_0\)</span>, <span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span>, <span class="math inline">\(\hat \beta_3\)</span>,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># beta0 + beta2 * 0.21</span>
<span class='fl'>54238.08</span> <span class='op'>+</span> <span class='fl'>964.17</span> <span class='op'>*</span> <span class='fl'>0.21</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 54440.56</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># beta1 + beta3 * 0.21</span>
<span class='fl'>104.72</span> <span class='op'>+</span> <span class='fl'>15.07</span> <span class='op'>*</span> <span class='fl'>0.21</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 107.8847</code></pre>
</div>
<p>resulting in <span class="math display">\[\widehat{\text{salary}} |_{\text{time} = 7} = 54440.6 + 107.9 (\text{pub}^c), \]</span> which is the regression line for <code>time</code> = 7. Note, however, when an interaction is present, the regression slope will be different with a different value of <code>time</code>. So remember that</p>
<blockquote>
<p>An interaction means that the regression slope of a predictor depends on another predictor.</p>
</blockquote>
<p>We will further explore this in the class exercise this week.</p>
<h2 id="tabulate-the-regression-results">5. Tabulate the Regression Results</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://vincentarelbundock.github.io/modelsummary/reference/msummary.html'>msummary</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
  <span class='st'>"M1"</span> <span class='op'>=</span> <span class='va'>m1</span>,
  <span class='st'>"M2"</span> <span class='op'>=</span> <span class='va'>m2</span>,
  <span class='st'>"M3"</span> <span class='op'>=</span> <span class='va'>m3</span>,
  <span class='st'>"M3 + Interaction"</span> <span class='op'>=</span> <span class='va'>m4</span>
<span class='op'>)</span>,
fmt <span class='op'>=</span> <span class='st'>"%.1f"</span>
<span class='op'>)</span> <span class='co'># keep one digit</span>
</code></pre>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
M1
</th>
<th style="text-align:center;">
M2
</th>
<th style="text-align:center;">
M3
</th>
<th style="text-align:center;">
M3 + Interaction
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept)
</td>
<td style="text-align:center;">
48439.1
</td>
<td style="text-align:center;">
56515.1
</td>
<td style="text-align:center;">
47373.4
</td>
<td style="text-align:center;">
54238.1
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(1765.4)
</td>
<td style="text-align:center;">
(1620.5)
</td>
<td style="text-align:center;">
(2281.8)
</td>
<td style="text-align:center;">
(1183.0)
</td>
</tr>
<tr>
<td style="text-align:left;">
pub
</td>
<td style="text-align:center;">
350.8
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
(77.2)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
sexfemale
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
−3902.1
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(2455.6)
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
pub_c
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
133.0
</td>
<td style="text-align:center;">
104.7
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(92.7)
</td>
<td style="text-align:center;">
(98.4)
</td>
</tr>
<tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
1096.0
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(303.6)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
time_c
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
964.2
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
(339.7)
</td>
</tr>
<tr>
<td style="text-align:left;">
pub_c × time_c
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
15.1
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
(17.3)
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
62
</td>
<td style="text-align:center;">
62
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.256
</td>
<td style="text-align:center;">
0.040
</td>
<td style="text-align:center;">
0.391
</td>
<td style="text-align:center;">
0.399
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.244
</td>
<td style="text-align:center;">
0.024
</td>
<td style="text-align:center;">
0.370
</td>
<td style="text-align:center;">
0.368
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
1301.0
</td>
<td style="text-align:center;">
1316.8
</td>
<td style="text-align:center;">
1290.6
</td>
<td style="text-align:center;">
1291.8
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
1307.4
</td>
<td style="text-align:center;">
1323.1
</td>
<td style="text-align:center;">
1299.1
</td>
<td style="text-align:center;">
1302.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
−647.486
</td>
<td style="text-align:center;">
−655.383
</td>
<td style="text-align:center;">
−641.299
</td>
<td style="text-align:center;">
−640.895
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:center;">
20.665
</td>
<td style="text-align:center;">
2.525
</td>
<td style="text-align:center;">
18.922
</td>
<td style="text-align:center;">
12.817
</td>
</tr>
</tbody>
</table>
</div>
<h2 id="bonus-matrix-form-of-regression">Bonus: Matrix Form of Regression</h2>
<p>The regression model can be represented more succintly in matrix form: <span class="math display">\[\bv y = \bv X \bv \beta + \bv e,\]</span> where <span class="math inline">\(\bv y\)</span> is a column vector (which can be considered a <span class="math inline">\(N \times 1\)</span> matrix). For example, for our data</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>salary_dat</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;#   id time pub    sex citation salary       pub_c     time_c
&gt;# 1  1    3  18 female       50  51876  -0.1774194 -3.7903226
&gt;# 2  2    6   3 female       26  54511 -15.1774194 -0.7903226
&gt;# 3  3    3   2 female       50  53425 -16.1774194 -3.7903226
&gt;# 4  4    8  17   male       34  61863  -1.1774194  1.2096774
&gt;# 5  5    9  11 female       41  52926  -7.1774194  2.2096774
&gt;# 6  6    6   6   male       37  47034 -12.1774194 -0.7903226</code></pre>
</div>
<p>So <span class="math display">\[\bv y = \begin{bmatrix}
            51,876 \\
            54,511 \\
            53,425 \\
            \vdots
          \end{bmatrix}\]</span> <span class="math inline">\(\bv X\)</span> is the predictor matrix (sometimes also called the design matrix), where the first column is the constant 1, and each subsequent column represent a predictor. You can see this in R</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;#   (Intercept)       pub_c time
&gt;# 1           1  -0.1774194    3
&gt;# 2           1 -15.1774194    6
&gt;# 3           1 -16.1774194    3
&gt;# 4           1  -1.1774194    8
&gt;# 5           1  -7.1774194    9
&gt;# 6           1 -12.1774194    6</code></pre>
</div>
<p>The coefficient <span class="math inline">\(\bv \beta\)</span> is a vector, with elements <span class="math inline">\(\beta_0, \beta_1, \ldots\)</span>. The least square estimation method is used to find estimates of <span class="math inline">\(\beta\)</span> that minimizes the sum of squared differences between <span class="math inline">\(\bv y\)</span> and <span class="math inline">\(\bv X \hat{\bv \beta}\)</span>, which can be written as <span class="math display">\[(\bv y - \bv X \bv \beta)^\top(\bv y - \bv X \bv \beta).\]</span> The above means that: for each value observation, subtract the predicted value of <span class="math inline">\(y\)</span> from the observed <span class="math inline">\(y\)</span> (i.e., <span class="math inline">\(y_i - \beta_0 + \beta_1 x_{1i} + \ldots\)</span>), then squared the value (<span class="math inline">\([y_i - \beta_0 + \beta_1 x_{1i} + \ldots]^2\)</span>), then sum these squared values across observations. Or sometimes you’ll see it written as <span class="math display">\[\lVert\bv y - \bv X \bv \beta)\rVert^2\]</span> It can be shown that the least square estimates can be obtained as <span class="math display">\[(\bv X^\top \bv X)^{-1} \bv X^\top \bv y\]</span> You can do the matrix form in R:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>salary_dat</span><span class='op'>$</span><span class='va'>salary</span>
<span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='va'>m3</span><span class='op'>)</span>
<span class='co'># beta = (X'X)^{-1} X'y</span>
<span class='co'># solve() is matrix inverse; t(X) is the transpose of X; use `%*%` for matrix multiplication</span>
<span class='op'>(</span><span class='va'>betahat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/solve.html'>solve</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='va'>X</span>, <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='va'>X</span><span class='op'>)</span> <span class='op'>%*%</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>  <span class='co'># same as the coefficients in m3</span>
</code></pre>
</div>
<pre><code>&gt;#                   [,1]
&gt;# (Intercept) 47373.3792
&gt;# pub_c         132.9984
&gt;# time         1096.0273</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Sum of squared residual</span>
<span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>betahat</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 3500978295</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Root mean squared residual (Residual standard error)</span>
<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>y</span> <span class='op'>-</span> <span class='va'>X</span> <span class='op'>%*%</span> <span class='va'>betahat</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>59</span><span class='op'>)</span>  <span class='co'># same as in R</span>
</code></pre>
</div>
<pre><code>&gt;# [1] 7703.156</code></pre>
</div>
<h2 id="bonus-more-options-in-formatting-tables">Bonus: More Options in Formatting Tables</h2>
<p>Here’s some code you can explore to make the table output from <code>msummary()</code> to look more lik APA style (with an example here: <a href="https://apastyle.apa.org/style-grammar-guidelines/tables-figures/sample-tables#regression" class="uri">https://apastyle.apa.org/style-grammar-guidelines/tables-figures/sample-tables#regression</a>). However, for this course I don’t recommend spending too much time on tailoring the tables; something clear and readable will be good enough.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Show confidence intervals and p values</span>
<span class='fu'><a href='https://vincentarelbundock.github.io/modelsummary/reference/msummary.html'>msummary</a></span><span class='op'>(</span>
  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    <span class='st'>"Estimate"</span> <span class='op'>=</span> <span class='va'>m4</span>,
    <span class='st'>"95% CI"</span> <span class='op'>=</span> <span class='va'>m4</span>,
    <span class='st'>"p"</span> <span class='op'>=</span> <span class='va'>m4</span>
  <span class='op'>)</span>,
  estimate <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"estimate"</span>, <span class='st'>"[{conf.low}, {conf.high}]"</span>, <span class='st'>"p.value"</span><span class='op'>)</span>,
  statistic <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='co'># suppress gof indices (e.g., R^2)</span>
  gof_omit <span class='op'>=</span> <span class='st'>".*"</span>,
  <span class='co'># Rename the model terms ("current name" = "new name")</span>
  coef_rename <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
    <span class='st'>"(Intercept)"</span> <span class='op'>=</span> <span class='st'>"Intercept"</span>,
    <span class='st'>"pub_c"</span> <span class='op'>=</span> <span class='st'>"Number of publications"</span>,
    <span class='st'>"time_c"</span> <span class='op'>=</span> <span class='st'>"Time since PhD"</span>,
    <span class='st'>"pub_c:time_c"</span> <span class='op'>=</span> <span class='st'>"Publications x Time"</span>
  <span class='op'>)</span>
<span class='op'>)</span>
</code></pre>
</div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Estimate
</th>
<th style="text-align:center;">
95% CI
</th>
<th style="text-align:center;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:center;">
54238.084
</td>
<td style="text-align:center;">
[51870.023, 56606.145]
</td>
<td style="text-align:center;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of publications
</td>
<td style="text-align:center;">
104.724
</td>
<td style="text-align:center;">
[−92.273, 301.720]
</td>
<td style="text-align:center;">
0.292
</td>
</tr>
<tr>
<td style="text-align:left;">
Time since PhD
</td>
<td style="text-align:center;">
964.170
</td>
<td style="text-align:center;">
[284.218, 1644.122]
</td>
<td style="text-align:center;">
0.006
</td>
</tr>
<tr>
<td style="text-align:left;">
Publications x Time
</td>
<td style="text-align:center;">
15.066
</td>
<td style="text-align:center;">
[−19.506, 49.637]
</td>
<td style="text-align:center;">
0.387
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>© Copyright 2021 Hok Chio (Mark) Lai</p>
<p>Template by <a href="https://github.com/distillpub/template/blob/master/AUTHORS">The Distill Template Authors</a> and <a href="https://www.rstudio.com">RStudio, Inc</a>.</p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
